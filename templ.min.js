/*! Templatejs - v1.0 - 19/11/2012
* https://github.com/mrjor/templatejs
* Copyright (c) 2012 Joran Veenstra; Licensed MIT */
window.TEMPL=window.TEMPL||{},TEMPL=function(){function c(){if(a.length>1){a.pop();var b=a[a.length-1].page,c=a[a.length-1].data;b.opt.data=c,b.show(!1)}else debug.log("laatste item")}function d(){return b}function e(){return a}function f(c){function g(){f.opt=$.extend(f.opt,c)}function h(){f.cache!=""?i(f.cache):d.load(f.opt.url,i)}function i(c){var d=$(f.opt.target);if(d.length!=0){n(c);var g=$(f.cache).imagesLoaded();g.always(function(){var c=f.cache,d="",g=Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+c.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");d=$(g(f.data)),d.data(f.data),f.opt.type=="page"&&(b=d.attr("id")),e&&a.push({page:f,data:f.opt.data}),$(f.opt.target).trigger("update",{html:d}),k()})}else debug.log(f.opt.target+" bestaat niet"),m()}function j(){f.queue.push(f.opt.data),f.queue.length==1&&l()}function k(){f.queue.shift(),l()}function l(){f.queue.length!=0&&(f.data=f.queue[0],h())}function m(){f.queue=[]}function n(a){f.cache==""&&(f.cache=a)}var d=$("<div>"),e=!0,f=this;f.queue=[],f.data={},f.cache="",f.opt={url:!1,data:{},target:"body",type:"page"},g(),f.show=function(a){if(f.opt.type!="page"||a==0)e=!1;j()},f.get_cache=function(){return f.cache}}var a=[],b="";return{create:f,history:e,back:c,currentpage:d}}()